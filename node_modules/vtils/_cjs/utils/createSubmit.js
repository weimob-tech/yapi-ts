"use strict";

exports.__esModule = true;
exports.createSubmit = createSubmit;

var _run = require("./run");

var _wait = require("./wait");

/**
 * 创建提交类行为。
 *
 * @param options 选项
 */
function createSubmit(options) {
  var payload = {
    start: function start(message) {
      return (0, _run.run)(function () {
        return options.start(message);
      });
    },
    fail: function fail(message, duration) {
      if (duration === void 0) {
        duration = 1500;
      }

      return (0, _run.run)(function () {
        return options.fail(message, duration);
      }).then(function () {
        return (0, _wait.wait)(duration);
      });
    },
    success: function success(message, duration) {
      if (duration === void 0) {
        duration = 1500;
      }

      return (0, _run.run)(function () {
        return options.success(message, duration);
      }).then(function () {
        return (0, _wait.wait)(duration);
      });
    }
  };
  return function (action) {
    return action(payload).then(function (res) {
      return (0, _run.run)(function () {
        return options.complete();
      }).then(function () {
        return res;
      });
    }).catch(function (error) {
      if (options.throw) {
        options.throw(error);
      }

      return Promise.reject(error);
    });
  };
}